<!DOCTYPE html>
<html ng-app>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body>
    <h1><%= title %></h1>
    <p>Welcome to <%= title %></p>
    <div ng-controller="ChatCtrl">
        <ul>
            <li ng-repeat="message in messages track by $index">{{message}}</li>
        </ul>

        <form ng-submit="sendMessage()">
            <input type="text" ng-model="messageText" placeholder="Type your message here" />
            <input type="submit" value="Send" />
        </form>
    </div>
    <script type="text/javascript" src="/bower_components/angular/angular.min.js"></script>
    <script type="text/javascript" src="/bower_components/sockjs-client/dist/sockjs.js"></script>
    <script type="text/javascript">
        var sock = new SockJS('http://localhost:3000/motion');
        function ChatCtrl($scope) {
            $scope.messages = [];
            $scope.sendMessage = function() {
                sock.send($scope.messageText);
                $scope.messageText = "";
            };

            sock.onmessage = function(e) {
                $scope.messages.push(e.data);
                $scope.$apply();
            };
        }
    </script>
  </body>
</html>
